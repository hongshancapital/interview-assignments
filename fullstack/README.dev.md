# 容量估计

假设:

1. 假设生成和读取的比例是 `1:50`
2. 假设每月有 `100万` 短地址生成
3. 假设需要稳定运行 24 个月, 每个存储对象为 0.5KB

因此:

1. 生成接口的 QPS `100万 / (30 * 24 * 60 * 60) = 0.38`
2. 读取接口的 QPS `0.38 * 50 = 19.3`
3. 总存储空间 `100万 * 24 * 0.5KB = 12G`

缓存: 按照热门 20% 计算需要内存 `12G * 20% = 2.4G`

结论:

单节点即可满足需求

# 短地址设计

采用 62 进制表示, 既 `0-9 a-z A-Z`

`6 位自增 ID` + `2 位节点标识` 的方式表示

6 位可以 62 进制可以表示 `62^6 = 56800235584` 500 亿, 因此 ID 是绝对够用的

# 横向扩展

如果实际运行超出假设, 需要可以通过水平扩容来满足需求

| 整体思路, 将水平扩容压力转移到 数据库集群 和 Redis 分片上

节点设计成可横向扩展, 外层通过 LB 负载到多个节点

每个节点通过唯一节点 ID 加 数据库自增 ID 生成为一个 短地址 alias


![arch](./images/arch.png)