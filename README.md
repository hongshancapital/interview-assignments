## 如果你还没听说过「红杉」...

身为工程师的你一定听说过这些公司: Apple, Google, GitHub...

作为「创业者背后的创业者」，红杉中国投资了阿里巴巴、京东、头条、美团点评等互联网头部企业。

## 开放岗位

武汉/三亚：
- [TypeScript Fullstack](fullstack/)
- [TypeScript Frontend](frontend/)
- [Swift](swift/)
- [Java](java/)

~~北京/武汉:~~
~~- [UI 设计师](design/)~~

北京/香港/深圳：
- [IT Support Engineer](it-support-engineer/)

~~北京：~~
~~- [DevOps](dev-ops/)~~

链接中有更为具体的 JD。

## interview-assignments

The monorepo for interview take home assignments.

Please find your assignment in subfolder accordingly.

## 红杉专属T-shirt
通过线上测试并顺利进入后续面试的同学，不论我们最终能否有幸与你共事，红杉都为技术出众的你特意准备了印有红杉logo的专属T-shirt（款式随机发放），请在面试时告知我们T-shirt尺码大小（180 vs 170），以及邮寄地址联系方式。希望你能喜欢我们准备的这份小礼物！
![WechatIMG145](https://user-images.githubusercontent.com/89758/135418812-74b86ed4-b980-4b81-aa00-732daa07957f.jpeg)

## 这样一家投资公司为什么要招工程师 / 设计师？

为红杉中国各团队提供数字化支持，持续整合业务，提升能效，创造新机会。投资了这么多高新互联网企业，我们自身的脚步也不想停下。

虽然不是面向公众的产品但有很多有意思的地方，具体的我们面试聊。

## 在投资公司做技术 / 设计是不是属于边缘业务？

对于其他投资公司，我们不太清楚。但在红杉中国，我可以肯定地告诉你，工程师所做的不会是写几个简单的展示型页面，设计师也不会只是画图。你将会：

1. 接触到真实业务场景与核心需求，参与制定世界顶级 PE / VC 的日常业务流程
2. 从用户的角度出发思考产品逻辑与方向
3. 近距接触投资人们的喜怒哀乐 (接 bug)
4. 独立地负责整块功能，跟随产品一起迭代整体技术架构

## 技术栈是？

设计：Figma

前端: TypeScript + React

后端: TypeScript + Express

移动端: SwiftUI

如此激进的选择得益于完善的设备管理以及项目所处的阶段，你不用花大量时间处理不同设备的兼容问题或陈旧的代码，只需要关注技术本身。

## 实力如何？

团队成员来自 AWS、字节跳动、快手、阿里、猿辅导 等企业，深知做好技术的重要性。所以我们在尽可能的范围内将流程做到最规范：CI / CD / Code Review 一样都没落下。再厚脸皮举两个例子：

1. 有工程师在入职后感叹：没想到对产品和 Code Review 的要求如此严格，不过同时也能学到很多新东西
2. 设计师说：不再只是 “画图的”，而是能真正地思考并把握一个产品的设计与体验

## 说了这么多优点，难道没有缺点吗？

肯定不是。如果你想发展的是高并发 / 高可用等基础架构方向，诚实地说我们短期内没有合适的岗位。

但如果你想在保持开发技术的同时，去探索一块新的领域，去深度理解用户需求与产品间的联系，去从更高层的角度看待你所在的行业，这将是一个不错的机会。

## 团队氛围呢？

两个词：高效与平等。

1. 我们不愿意大家的时间花在无意义的事情上。大家曾不经意抱怨写周报需要占用时间，于是我们马上取消了周报，并改为每周计划会的形式来规划产品与同步进度
2. 在这里没有谁比谁的职级高，只有事实与道理。只要言之有理，每一个人都可以发出自己的声音。我们的设计师经常说：“这是开发与设计相处得最融洽的团队”
3. 出现了问题我们的方案是先解决，随后建立相关的机制避免重蹈覆辙，而不是去一味地责怪某一个人
4. 不鼓励加班，更看重效率

## 有些什么福利？

我们不打算靠福利来吸引优秀的你，不过该有的都不会缺：

1. 最新 MacBook Pro
2. 外设（键鼠，升降桌，高清显示器…）
3. 无限冷热饮/小吃供应

至于薪水，我们想要找到合适的人而不是想一味地压缩成本。给出的 package 不输互联网大厂，相信能让你满意。

## 会不会存在类似互联网企业的的一些坑？

工作时间：双休，结果导向，倡导提升效率而不是加班

年龄限制：没有。团队成员 70 后到 90 后都有分布

学历要求：不限。面试通过都好说

## 你们的技术太新了，我没有用过...

没关系。我们并不需要你的经历 100% 匹配上文提到的技术栈，如果你有三年以上（可以有例外）技术相关的工作经历，并愿意：

1. 花一些时间学习并做一份简单的作业
2. 面试来进一步确认我们的岗位符合你的预期

我们随时欢迎你的到来。

## 作业在哪？如何提交？

### 设计师

发送你的作业和简历/作品集至以下地址：

```
cmVjcnVpdGluZy5kZXNpZ25Ac2VxdW9pYWNhcC5jb20=
```

（防止爬虫进行了 base64 编码，可以通过[这个链接](https://tool.oschina.net/encrypt?type=3)进行解析）


### 其他岗位

Fork 当前仓库并在相关文件夹下找到你的作业。完成作业后提交一个 Pull Request 即可。如果方便，可以在 PR 描述中留下你的简历。

## 还有其他要补充的吗？

1. 面试不会问茴字有几种写法，甚至不会限制语言。我们看重的是解决问题的能力，以及发散思维的能力
2. 所有办公地点在市区，交通便利


# 短链接服务
长链接转短链接的服务实现。

## 服务需求
实现两个接口：
1. 将长链接转换为短链接
2. 将短链接转换为对应长链接

转换时需满足一下条件：
1.将任意长度长链接转成长度固定为8位的短链接
2.数据映射存储在JVM内存，除了存储长链接到短链接的映射，还需要短链接到长链接的映射

## 思考
将不定长明文转换成定长值，第一反应是可以使用类似SHA的定长秘钥加密算法，但分析后存在以下问题：
1.算法难以实现，且加密算法通常无法逆运算，查阅资料后也并没有找到相应的实现案例
2.无法避免哈希碰撞

故只能选择其他方式实现服务，在查阅资料并对比思考后决定使用发号器模式实现服务，下面介绍实现方案。

## 服务设计实现
流程图：
![shortUrlConverter流程图](https://user-images.githubusercontent.com/25141265/161380587-fd55e65b-c80d-4eee-ad51-d0d6c6301d30.jpg)

架构设计图：
![shortUrlConverter架构设计图](https://user-images.githubusercontent.com/25141265/161987494-638b3948-ef20-4c0b-8219-d964254d5d9d.jpg)


### 发号器实现
1.发号器给每个长链接发送一个专属号码，号码和对应长链接互为映射。
2.发号器采用自增的逻辑，从0号开始给发送请求的链接编号，为了在有限的长度下容纳更多号码，短链接采用62进制(a-zA-Z0-9])，那么在8位的情况下，发号器总共可以发送62^8数量的号码。
3.为了提高服务的的可用性，将其拓展为分布式服务，进行分行分列，此处实现的方法为利用短链接的第一位进行分列，即分为62列，每列由一个发号器自增发号（例：列名为V的发号器发送的第一个号码为V000000a)，每个发号器最多发送62^7个号码。
4.服务启动时初始化一个含有62个发号器的发号器池，收到请求后从池子中随机抽取出一个发号器并发送该发号器的下一个号码，每个发号器发号时需加锁避免重复发号，若该发号器已无剩余号码则重新随机取出另一个发号器，若达到重试次数上限则转换失败。

### 缓存实现
1.使用性能较高的CaffenineCache来实现KV结构缓存。
2.服务接到长链接转短链接请求时会优先查找缓存内是否有长链接映射信息，若没有则请求发号器池发号，并将生成的映射关系存入缓存。
3.缓存在存储长链接到短链接的映射时，还同时存储长链接到短链接的映射，方便逆向查找(由于短链接的格式属于无效长链接，并不会被当作长链接存入缓存中，所以此处不会发生哈希碰撞)。
4.服务接到短链接转长链接时会直接去缓存中查找该短链接是否存在映射。

## 功能Demo
自定义状态码:
200: 转换成功
40X：转换失败，详情查看description

### 长链接转短链接
1.缓存中不存在长链接

![image](https://user-images.githubusercontent.com/25141265/161379102-078a6cc2-fded-430d-b1f5-2f3fc921ed39.png)

2.缓存中已存在该长链接
![image](https://user-images.githubusercontent.com/25141265/161379112-6c7887e8-c0b1-41d6-8c68-af3f8b76882c.png)

3.长链接不合法
![image](https://user-images.githubusercontent.com/25141265/161379129-563ff281-8472-4d12-8e13-a72c867881fc.png)

### 短链接转长链接
1.缓存中存在短链接
![image](https://user-images.githubusercontent.com/25141265/161379167-ccb42772-daa7-4ad3-b8a0-fe290a76f42d.png)

2.缓存中该短链接不存在
![image](https://user-images.githubusercontent.com/25141265/161379267-8b5f9f56-dc87-407b-ba4c-e6f531643238.png)

3.短链接不合法
![image](https://user-images.githubusercontent.com/25141265/161379360-1777edb6-e8f0-48e8-ba1b-f03feb515990.png)


## 未来拓展
由于时间关系，很多功能尚未来得及实现，未来可以从以下方面继续优化服务：
1.缓存并没有做持久化，有数据丢失的风险，持久化的设计思路是利用LRU Cache思想，记录缓存每个映射关系的最近查找时间，定期将超时的记录持久化到DB或构建倒排索引存储在引擎中。
2.发号器分列策略还有改进空间，后期可以改进算法，允许使用可变大小的发号器池。
3.从发号器池中随机抽取发号器是为了在大样本条件下尽量平衡每个发号器的负载，不过还是有数据倾斜的风险，未来可以改进分配发号器算法。

## Swagger API文档
![image](https://user-images.githubusercontent.com/25141265/161379859-ee5207c5-1bee-442a-bc1d-1e259d44830a.png)
![image](https://user-images.githubusercontent.com/25141265/161988604-5ee71187-d3b4-4fec-9c0f-d57fd02feabd.png)
![image](https://user-images.githubusercontent.com/25141265/161988721-c06c871e-291c-4e81-aeb2-f3eaa1e95b6c.png)



## Jacoco覆盖率测试
![169ff16f57e61eafaf7a1e4867409fe](https://user-images.githubusercontent.com/25141265/161379752-6877a522-e12c-4ae7-bac6-fa6add94fcc6.png)

## 个人信息
姓名：葛韬
电话: 18040511707
邮箱: taoyyyge@gmail.com

## 工作经历
2021.4 - 至今      阿里巴巴(中国)有限公司

工作职责：搜推广离线引擎后端开发


2020.10 - 2021.1   北京字节跳动信息科技有限公司 (实习)

工作职责：广告系统DMP平台后端开发


2020.6 - 2020.9    深圳虾皮信息科技有限公司 (实习)

工作职责：电商游戏平台后端开发

## 教育经历
2019.3 - 2021.7 澳大利亚 墨尔本大学 IT 硕士

2015.3 - 2018.12 新西兰 奥克兰大学 Computer Systems Engineering 荣誉学士


