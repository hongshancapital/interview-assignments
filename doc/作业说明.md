# short-url

---

## 需求分析：
1. 输入：长域名 输出：短域名；
2. 长域名短域名一一对应关系，且长期有效；
3. 这是一个读多写少的系统（宜用kv数据库）； 对读的延时要求较高；
4. 可靠性要求比较高（基础服务）

---

## 接口拆解
1. 写接口
   输入长域名,判断是否曾经存存在 ?
    如果存在：直接返回对应的短域名；
    如果不存在：生成一个新的短域名，关联存入mongoDB中；
2. 读接口
  获取短域名,根据短域名进行数据库查询， 如果存在返回对应的长域名；如果不存在返回原参数错误；

---

## 关键点分析：

#### 1. 短域名生成（总数考量）
    采用mongodb,sum自增的方式，将sum总数转变为62进制的字符串。对于不超过8位的短链接，最多可以存放 62^8 ≈ 218,340,105,584,896 个链接

#### 2. 写：长短域名对应关系，及唯一性：
    存入同一个集合中，确保对应对应关系，增加唯一索引确保数据的唯一性；

#### 3. 读：并发问题，低延迟：
    增加redis缓存k-v(短域名-长域名）；
    水平扩展,NGINX做负载均衡；利用函数计算，容器等技术弹性自动扩容；
    冷热数据分离处理，热数据尽量放到redis中；

#### 4. 可靠性
    需要做好数据备份；确保数据安全；
    做好性能监控，确保服务稳定
