## 测试方式：

使用jmeter进行多路并发压测 /short-url/?longUrl=xxxx、/short-url/?shortUrl=xxxx两个接口，具体参数使用程序随机生成1000行长链接和短链接，具体内容如下图所示，测试线程数量为20、50、100时，系统的吞吐量和响应时间。

### long.txt

![image-20220425231437518](.\img\性能压测\image-20220425231437518.png)

### short.txt

![image-20220425231454577](.\img\性能压测\image-20220425231454577.png)



## 服务部署

本地项目启动，指定堆最大值最小值为2G，使用G1垃圾回收器。

## 测试机配置

- CPU：Intel i5-6300HQ
- 内存：8G
- 系统：Windows10 教育版 64位

## /short-url/?longUrl=xxxx测试结果

### 100个线程，每个线程请求100次

- 结果截图

![image-20220426000743928](.\img\性能压测\image-20220426000743928.png)

> 最小响应时间为0ms，最大响应时间为2169ms，平均响应时间29ms。p95为120ms，p99为182ms。吞吐量2540/s

### 300个线程，每个线程请求100次

- 结果截图

  ![image-20220426001055922](.\img\性能压测\image-20220426001055922.png)

  > 最小响应时间为0ms，最大响应时间为804ms，平均响应时间131ms。p95为334ms，p99为505ms。吞吐量2061/s
  
  > 分析：最大响应时间比100组线程的情况小，原因是大部分测试用例已经被服务保存。

### 500个线程，每个线程请求100次

- 结果截图

![image-20220426000840623](.\img\性能压测\image-20220426000840623.png)

> 最小相应时间为0ms，最大响应时间为1116ms，平均响应时间200ms。p95为335ms，p99为415ms。吞吐量2330/s

## /short-url/?shortUrl=xxxx 测试结果

### 100个线程，每个线程请求100次

- 结果截图

![](.\img\性能压测\image-20220427091939239.png)

> 最小相应时间为0ms，最大响应时间为788ms，平均响应时间6ms。p95为29ms，p99为79ms。吞吐量5688/s

> 分析：重启了下项目，缓存为空，响应时间较长，预计后边吞吐量会随着请求的次数越来越多变高。

### 300个线程，每个线程请求100次

- 结果截图

  ![](.\img\性能压测\image-20220427092223179.png)

  > 最小相应时间为0ms，最大响应时间为743ms，平均响应时间42ms。p95为318ms，p99为495ms。吞吐量4980/s

### 500个线程，每个线程请求100次

![](.\img\性能压测\image-20220427092104454.png)

> 最小相应时间为0ms，最大响应时间为1272ms，平均响应时间66ms。p95为287ms，p99为572ms。吞吐量5144/s