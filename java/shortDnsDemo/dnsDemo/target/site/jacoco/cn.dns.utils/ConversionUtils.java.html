<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ConversionUtils.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">dnsDemo</a> &gt; <a href="index.source.html" class="el_package">cn.dns.utils</a> &gt; <span class="el_source">ConversionUtils.java</span></div><h1>ConversionUtils.java</h1><pre class="source lang-java linenums">package cn.dns.utils;


import cn.dns.exception.CheckArgsException;

/**
 * 「十进制与62进制互相转换」的算法
 * &lt;table&gt;
 *     &lt;tr&gt;
 *         &lt;th&gt;ASCII可显示字符&lt;/th&gt;&lt;th&gt;对应十进制数字范围&lt;/th&gt;
 *     &lt;/tr&gt;
 *     &lt;tr&gt;
 *         &lt;td&gt;0-9&lt;/td&gt;&lt;td&gt;48~57&lt;/td&gt;
 *     &lt;/tr&gt;
 *     &lt;tr&gt;
 *         &lt;td&gt;A-Z&lt;/td&gt;&lt;td&gt;65~90&lt;/td&gt;
 *     &lt;/tr&gt;
 *     &lt;tr&gt;
 *         &lt;td&gt;a-z&lt;/td&gt;&lt;td&gt;97~122&lt;/td&gt;
 *     &lt;/tr&gt;
 * &lt;p&gt;在本工具中，约定代表62进制的62位序列为以下格式：0-9A-Za-z&lt;/p&gt;
 */
<span class="nc" id="L23">public class ConversionUtils {</span>

    /**
     * 在进制表示中的字符集合，0-Z分别用于表示最大为62进制的符号表示
     */
<span class="fc" id="L28">    private static final char[] DIGITS = {'0', '1', '2', '3', '4', '5', '6', '7', '8', '9',</span>
            'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm',
            'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z',
            'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M',
            'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'};

<span class="fc" id="L34">    private static final Integer DECIMAL = 10;</span>

<span class="fc" id="L36">    private static Long maxNumber = -1L;</span>



    /**
     * 生成指定长度短域名
     * @param number 随机数字
     * @param seed   步长
     * @param length 生成域名长度
     * @return
     */
    public static String convertToByLength(long number, int seed, int length)  {
<span class="pc bpc" id="L48" title="1 of 2 branches missed.">        if (maxNumber == -1) {</span>
<span class="fc" id="L49">            maxNumber = new Double(Math.pow(62, length - 1)).longValue();</span>
        }
<span class="pc bpc" id="L51" title="1 of 2 branches missed.">        if (number &gt; maxNumber) {</span>
<span class="nc" id="L52">            throw new CheckArgsException(&quot;短域名超长,最长&quot; + length + &quot;位&quot;);</span>
        }

<span class="fc" id="L55">        return convertTo(number, seed);</span>
    }


    /**
     * 将十进制的数字转换为指定进制的字符串
     *
     * @param number 十进制的数字
     * @param seed   指定的进制
     * @return 指定进制的字符串
     */
    public static String convertTo(long number, int seed) {
<span class="pc bpc" id="L67" title="1 of 2 branches missed.">        if (number &lt; 0) {</span>
<span class="nc" id="L68">            number = ((long) 2 * 0x7fffffff) + number + 2;</span>
        }

<span class="fc" id="L71">        char[] buf = new char[32];</span>
<span class="fc" id="L72">        int charPos = 32;</span>
<span class="pc bpc" id="L73" title="1 of 2 branches missed.">        while ((number / seed) &gt; 0) {</span>
<span class="nc" id="L74">            buf[--charPos] = DIGITS[(int) (number % seed)];</span>
<span class="nc" id="L75">            number /= seed;</span>
        }
<span class="fc" id="L77">        buf[--charPos] = DIGITS[(int) (number % seed)];</span>
<span class="fc" id="L78">        return new String(buf, charPos, (32 - charPos));</span>
    }


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>