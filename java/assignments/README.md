# 设计思路

## 项目分析

	短码一般是由 [a - z, A - Z, 0 - 9] 这62 个字母或数字组成，短码的长度也可以自定义，但一般不超过8位。
	根据要求可以看出这个项目主要的两个功能点 长短域名的转换及获取 和 防止内存溢出。
* 长短域名的转换及获取
	
	有两种方案
	1. 摘要算法：将长网址md5生成32位签名串,将签名串按照 8 位一组 与0x3fffffff与操作, 得到4组30位的串，将这30位分成6段, 每5位的数字作为字母表的索引取得特定字符, 依次进行获得6位字符串；最终得到了4组6位串；取里面的任意一个就可作为这个长url的短url地址。
	2. 自增id: 每新增一个短码，就在上次添加的短码id基础上加1，然后将这个10进制的id值，转化成一个62进制的字符串。
	
	优缺点：	摘要算法有重复的几率，自增id可以保证唯一性；自增id长度不固定且有序可能会有安全的问题
	
* 防止内存溢出

	 项目要求使用jvm内存进行数据的存储，所以需要考虑到内存溢出的问题。考虑到有两种方案 LRU 和 将使用软引用对象做映射的key
	 软引用会增加gc次数LRU必须要制定映射的长度
	 
## 项目实现

	我是使用自增id、 LRU实现本项目的。
	用AtomicLong获取自增id值并转成62位的串；LRU：结合本项目的功能采用了 双向链表+2个hashmap（长短链接的相互映射关系）
	使用了读写锁保证了线程安全，在生成短连接的操作加了写锁，读取长链接的操作加了读锁
	 