# 设计文档

## 基本思路

- 通过AtomicLong从0开始自增获取ID并转62进制数（0-9a-zA-z）生成短码。短码长度可配置（短码长度配置项 short-url.max.url.length）。
- 根据短码长度判断自增ID的最大值，当超出最大值时抛出短码耗尽异常
- 实现LRU缓存保存短码-原始URL，并同步保存原始URL-短码避免重复消耗短码。缓存大小可配置（LRU缓存大小配置项 short-url.max.url.cacheSize）。

## 系统架构图

![avatar](./系统类图.png)

## 系统设定

- 原始URL长度不超过2083，需要符合URL格式规范
- 域名短码不超过配置长度，小于配置长度的高位补0。
- 保存的域名短码不超过服务配置的LRU存储大小，超过抛出异常。

## 性能测试说明

- 性能测试使用jmeter完成，测试坏境为1000线程同时请求，重复10次
- 获取长域名接口测试通过调用 api/short-url/parse?shortUrl=00000000 接口完成
- 生成短码接口测试 通过调用 api/short-url/generate 接口完成
- 在生成短码接口测试中，接口参数的变化通过jmeter的Counter组件获取自增变量实现

## 项目接口文档

- swagger地址：http://localhost:8080/swagger-ui.html#/short45url45controller







