plugins {
    id 'java'
    id 'org.springframework.boot' version '2.4.5'
    id 'idea'

}

group 'xyz.sgld'
version '1.0-SNAPSHOT'
apply plugin: 'io.spring.dependency-management'
apply plugin: "jacoco"
//apply plugin: 'pmd'
repositories {
    mavenCentral()
}
ext {
    p3c = "2.0.0"
}

//pmd {
//    consoleOutput = true
//    reportsDir = file("build/reports/pmd")
//    ignoreFailures = true
//    ruleSetConfig = resources.text.fromFile("etc/pmd/ruleset.xml")
//    ruleSets = [
//            "java-ali-comment"
//    ]
//}
dependencies {
    implementation 'org.jetbrains:annotations:20.1.0'
    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.7.0'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.7.0'
    testImplementation 'org.springframework.restdocs:spring-restdocs-webtestclient'
    testImplementation('org.springframework.boot:spring-boot-starter-test')


    //springboot
    implementation('org.springframework.boot:spring-boot-starter-web')
    implementation('org.springframework.boot:spring-boot-starter-data-jpa')

    //H2
    implementation('org.springframework.boot:spring-boot-starter-jdbc')
    implementation('com.h2database:h2')

    //swagger
    implementation('io.springfox:springfox-boot-starter:3.0.0')
//    pmd "com.alibaba.p3c:p3c-pmd:${p3c}"
}
jar {
    enabled = true
}


test {
    useJUnitPlatform()
    finalizedBy jacocoTestReport
}
jacocoTestReport {
    dependsOn test // tests are required to run before generating the report
}
jacoco {
    toolVersion = "0.8.7"
    reportsDirectory = layout.buildDirectory.dir('ShortLinkApiReports')
}