# 设计思路

该模块采用Map结构存储短域名和长域名的映射 实现采用`ConcurrentHashMap`保证线程的安全性, 根据估算业务需求量估算值可以初始化Map的大小.
长域名和短域名采用**MD5**和**随机数**算法, 在字典`dict`中依次获取8个字符返回.

## 短域名存储

为美观统一, 该接口统一采用8个字符长度作为短域名返回.
短域名算法采用MD5和随机数结合的方式. 首先采用MD5方式获取4组, 每组8个字符的短连接, 将短连接作为key尝试存入Map中, 如果没有冲突的key则可以正常存入返回`域名前缀+短域名`, 假设4组短域名都存在冲突, 则采用随机数方式获取8位字符, 判断是否存在key冲突, 如果存在则再次获取, 知道不冲突为之.
1. MD5:
由于随机数在数量较大时, 冲突更多, 所以优先采取MD5方式获取.
通过MD5算法得出32位摘要, 然后将摘要分为4组, 每组8个字符, 对应32位. 将32位循环8次, 每次循环后右移4位, 以此获得`dict`的坐标, 获取8个字符, 这样摘要一共可以获得4组8个字符的短域名.
字符字典采用大小写字母+数字+特殊字符组成, 参考`HashMap`取模算法, 将字典数量做成2^n, 这样在取模时可以通过位运算更高效的得到结果`num&(dict.length-1)`.
2. 随机数:
随机数作为补充算法, 在MD5全部冲突时, 不断循环直到得到一个不冲突的短域名.
采用`ThreadLocalRandom`实现, 能是多线程竞争激烈时获得更好的表现.

## 短域名读取

短域名作为key从Map中获取长域名, 存在则直接返回长域名, 不能存在则返回"not found".


# 架构设计图

![image](https://user-images.githubusercontent.com/24759865/169091418-84dc974d-c538-4d78-ab0c-ee1400c25bb8.png)

# 单测覆盖率

 ![image](https://user-images.githubusercontent.com/24759865/169090788-d486e7a8-59a8-4235-a817-5bbd2174b04d.png)
