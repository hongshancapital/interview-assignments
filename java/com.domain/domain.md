# 短域名

## 控制层

### 安全过滤-token
- 固定token串验证请求。

### 重复请求-resubmit
- 根据客户端地址、请求服务URL，利用缓存（可过期），缓存请求内容，在某时间段内（缓存未过期） 同样的请求内容，认为重复。

### 限流请求-limitrequest
- 根据客户端地址、利用缓存存储该地址对应的限流规则，判断请求是否需要限流？

### 功能请求
- 写-长转短域名 需要限流
- 读-短转长域名 不需要
- 短转长地址跳转


## 服务层
### 存储服务
- JVM缓存存储
1. LRU存储 老的数据可以淘汰掉
2. 多个LUR存储，降低存储压力。
3. 多个LUR存储，根据某个唯一值，进行下标换算，指定存储位置，查询时也可以根据下标快速查找
4. 单个LUR hash对象 减少扩容性能消耗，指定最大长度，控制扩容
- 持久化存储
1. 存储磁盘放肆，堆外内存映射磁盘文件，快速读写。
2. 映射文件创建固定大小占位，避免磁盘地址连续，影响读写性能
3. 映射最近读写文件指针、文件名在指定对象中，方便刷盘持久化
4. 写文件方式，异步刷盘
5. 突然kill服务 优雅停机 保证数据异步刷盘完成，数据不会丢失
  
### 域名服务
- 长域名生成短域名，地址映射限制8位
- 根据需要生成的对象，产生唯一值，计算获取存储目标指针？
- 域名转换快速获取

### 算法和工具
- 缓存工具，存储、限流、重复请求使用
- Hash槽算法，存储下标使用
- 刷盘线程服务
- 堆外映射文件读写基础服务
- 长短域名计算生成算法




